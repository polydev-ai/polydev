# Coturn TURN/STUN Server Configuration for Polydev AI V2
# WebRTC streaming for Browser VMs (OAuth flows)
# Target: <50ms latency vs 200ms noVNC

# Listening ports
listening-port=3478
tls-listening-port=5349

# Server IP configuration
# VPS external IP
external-ip=135.181.138.102

# Listening on all interfaces
listening-ip=0.0.0.0

# Relay IP range for UDP/TCP relay
relay-ip=135.181.138.102

# Server identification
realm=polydev.ai
server-name=turn.polydev.ai

# Authentication mechanism
# Use long-term credential mechanism for security
lt-cred-mech

# Static user credentials (change in production!)
# Format: user=username:password
user=polydev:PolydevWebRTC2025!

# Alternative: Use static auth secret (more secure)
# use-auth-secret
# static-auth-secret=YOUR_RANDOM_SECRET_HERE

# Port range for relay (UDP/TCP)
min-port=49152
max-port=65535

# Enable fingerprinting for security
fingerprint

# Logging
log-file=/var/log/turnserver/turnserver.log
verbose

# Disable stdout logging (use file only)
no-stdout-log

# Enable syslog
syslog

# Security settings
# Disable loopback peers
no-loopback-peers

# Disable multicast peers
no-multicast-peers

# Disable CLI (no telnet admin interface)
no-cli

# Rate limiting (prevent abuse)
max-bps=1000000  # 1 Mbps per allocation
total-quota=100   # Max 100 users
bps-capacity=0    # Unlimited total bandwidth

# Session management
stale-nonce=600   # Nonce expires after 10 minutes

# Mobility support for mobile clients
mobility

# TLS/DTLS configuration (optional, for HTTPS)
# Uncomment and configure if you have SSL certificates
# cert=/etc/letsencrypt/live/turn.polydev.ai/cert.pem
# pkey=/etc/letsencrypt/live/turn.polydev.ai/privkey.pem
# cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512"

# Performance tuning
# Number of relay threads
relay-threads=4

# Process user/group (security)
proc-user=turnserver
proc-group=turnserver
